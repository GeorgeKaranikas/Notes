




# Directory Fuzzing

the main two options are 
- -w for wordlists and 
- -u for the URL. 

We can assign a keyword to a wordlist to refer to it where we want to fuzz. For example, we can pick our wordlist and assign the keyword FUZZ to it by adding :FUZZ after it

```$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ```


Next, as we want to be fuzzing for web directories, we can place the FUZZ keyword where the directory would be within our URL, with:

```$ ffuf -w <SNIP> -u http://SERVER_IP:PORT/FUZZ```

before we start, we must find out what types of pages the website uses, like .html, .aspx, .php, or something else.


#### Manually check for extensions in site

#### Fuzz for extensions with ffuf

we can always (maybe not) find in most websites, the index.*, so we will use it as our file and fuzz extensions on it.

!!! Some wordlists might contain the . before the extension


```$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ```




# Recursive Fuzzing

- We can enable recursive scanning with the -recursion flag

- We can specify the depth with the -recursion-depth flag

```$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v```




# Sub-domain Fuzzing

    
```$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.hackthebox.eu/```




# Vhost Fuzzing

    
The key difference between VHosts and sub-domains is that a VHost is basically a 'sub-domain' served on the same server and has the same IP, such that a single IP could be serving two or more different websites.


!VHosts may or may not have public DNS records.


    To scan for VHosts, without manually adding the entire wordlist to our /etc/hosts, we will be fuzzing HTTP headers, specifically the Host: header. 

```$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'```




# Filtering Results

    
## response size  (  -fs )

```$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs 900```




## GET Request Parameter Fuzzing

SecLists has just that in /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt

```$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx```

    


 ##  Fuzzing POST request

To fuzz the data field with ffuf, we can use the -d flag and -X Post flag

Tip: In PHP, "POST" data "content-type" can only accept "application/x-www-form-urlencoded". So, we can set that in "ffuf" with "-H 'Content-Type: application/x-www-form-urlencoded'".


```$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx```
    






## Value Fuzzing

he following command in Bash that writes all numbers from 1-1000 to a file:

```$ for i in $(seq 1 1000); do echo $i >> ids.txt; done```

Our command should be fairly similar to the POST command we used to fuzz for parameters, but our FUZZ keyword should be put where the parameter value would be, and we will use the ids.txt wordlist we just created, as follows:

```$ ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx```

    

